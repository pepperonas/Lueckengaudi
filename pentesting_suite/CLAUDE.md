# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Common Commands

### Installation and Setup
```bash
pip install -r requirements.txt
```

### Running the Application
```bash
# CLI Interface
python pentest_cli.py --list-plugins
python pentest_cli.py scan PortScanner -t example.com --start-port 1 --end-port 1000

# GUI Interface
python pentest_gui.py
```

### Development Commands
```bash
# Code formatting
black .

# Linting
flake8 .

# Type checking
mypy .

# Running tests
pytest
pytest tests/test_specific.py  # Single test file
pytest -v  # Verbose output
pytest --cov  # Coverage report
```

## Architecture Overview

This is a modular pentesting suite built around a plugin architecture with the following core components:

### Core Framework (`core/`)
- **BasePlugin**: Abstract base class that all security plugins must inherit from. Defines the plugin interface with `execute()` and `validate_options()` methods, handles rate limiting, safe mode, and vulnerability tracking.
- **PluginManager**: Dynamically discovers, loads, and manages plugins from the `plugins/` directory. Handles concurrent plugin execution and plugin lifecycle.
- **ConfigManager**: Manages encrypted configuration files, target profiles, and security settings. Uses YAML for human-readable configs and Fernet encryption for sensitive data.
- **Logger**: Rich-formatted logging with audit capabilities. Supports both console output (with colors/styling) and file logging with audit trails.
- **Reporter**: Multi-format report generation (JSON/HTML/PDF) with Jinja2 templates and vulnerability severity classification.

### Plugin System
Plugins are automatically discovered from `plugins/` directory. Each plugin:
- Inherits from `BasePlugin`
- Implements async `execute()` method for the main scanning logic
- Returns `PluginResult` with structured data and discovered vulnerabilities
- Can define rate limiting and safe mode behavior

### Dual Interface Architecture
- **CLI (`pentest_cli.py`)**: Uses argparse for command parsing and rich for formatted output
- **GUI (`pentest_gui.py`)**: Built with tkinter/ttkbootstrap, features Material Design theming (#2C2E3B), tabbed interface, and async scan execution via threading

### Data Flow
1. User selects target and plugin via CLI/GUI
2. ConfigManager validates target against whitelist and loads profile settings
3. PluginManager executes the selected plugin with rate limiting and safety checks
4. Plugin performs security scan and populates vulnerabilities
5. Reporter generates output in requested format
6. Logger creates audit trail of all activities

### Security Features
- Target whitelisting to prevent unauthorized scans
- Rate limiting to avoid overwhelming targets
- Safe mode for production environments
- Audit logging for compliance
- Encrypted storage of sensitive configuration data

## Plugin Development

New plugins must inherit from `BasePlugin` and implement:
- `__init__()`: Set plugin name, version, description
- `execute(target, options)`: Main scanning logic (async)
- `validate_options(options)`: Validate input parameters
- Use `add_vulnerability()` to report security findings

The plugin system automatically handles plugin discovery, configuration management, and result aggregation.