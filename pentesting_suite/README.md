# Pentesting Suite

Eine modulare Pentesting Suite mit Plugin-Architektur für Sicherheitstests und Penetrationstests.

Entwickelt von **Martin Pfeffer** - 2025

## Features

- **Modulare Plugin-Architektur**: Einfach erweiterbar mit neuen Sicherheitstools
- **CLI und GUI Interface**: Kommandozeile mit rich output und moderne GUI mit Material Design
- **Konfigurationssystem**: Profile für verschiedene Targets und Szenarien
- **Reporting Engine**: Export in JSON, HTML und PDF Format
- **Sicherheitsfeatures**: Rate Limiting, Target Whitelisting, Audit Logging, Safe Mode
- **Async/Threading**: Performante, nicht-blockierende Scans
- **Cross-Platform**: Läuft auf Linux, macOS und Windows

## Verfügbare Module ✅

### Network Discovery
- **Port Scanner**: TCP/UDP Port Scanning mit Service Detection ✅
- **OS Fingerprinting**: Multi-Method OS Detection ✅
- **Network Mapping**: Topology Discovery und Device Classification ✅
- Service Detection und Banner Grabbing ✅

### Web Application Testing
- **Directory Bruteforcing**: Umfassende Directory/File Discovery ✅
- **SQL Injection Scanner**: Multi-Database Injection Testing ✅
- **XSS Detection**: Reflected, DOM-based, Stored XSS ✅
- **CSRF Testing**: Form Analysis und Token Validation ✅
- **SSL/TLS Analysis**: Certificate und Protocol Security ✅

### Network Services
- **SSH Bruteforcing**: Credential Testing und Banner Analysis ✅
- **FTP Testing**: Anonymous Access und Permission Testing ✅
- **SMB Enumeration**: Share Discovery und Null Session Testing ✅
- **DNS Enumeration**: Zone Transfer und Subdomain Discovery ✅

### Payload Generation
- **Reverse Shell Generator**: Multi-Platform Shell Generation ✅
- **Payload Encoder/Decoder**: 7+ Encoding Methods ✅
- **Exploit Templates**: SQL, XSS, LFI, Command Injection ✅
- **Obfuscation Tools**: Advanced Evasion Techniques ✅

### Core Framework
- **Plugin-Architektur**: Dynamisches Plugin Loading ✅
- **CLI Interface**: Rich-formatierte Kommandozeile ✅
- **GUI Interface**: Material Design Desktop App ✅
- **Reporting Engine**: JSON/HTML/PDF Export ✅
- **Configuration System**: Profile und Target Management ✅
- **Security Features**: Rate Limiting, Safe Mode, Audit Logging ✅

## Installation

```bash
# Repository klonen
git clone https://github.com/martinpfeffer/pentesting-suite.git
cd pentesting-suite

# Dependencies installieren
pip install -r requirements.txt

# Skripte ausführbar machen
chmod +x pentest_cli.py pentest_gui.py
```

## Verwendung

### CLI Interface

```bash
# Verfügbare Plugins anzeigen
python pentest_cli.py --list-plugins

# Verfügbare Profile anzeigen
python pentest_cli.py --list-profiles

# ==> NETWORK DISCOVERY <==
# Port Scanning
python pentest_cli.py scan PortScanner -t example.com --start-port 1 --end-port 1000

# OS Fingerprinting
python pentest_cli.py scan OSFingerprinting -t example.com --host example.com

# Network Mapping
python pentest_cli.py scan NetworkMapper -t "192.168.1.0/24" --network "192.168.1.0/24"

# ==> WEB APPLICATION TESTING <==
# Directory Bruteforcing
python pentest_cli.py scan DirectoryBruteforce -t example.com --url https://example.com

# SQL Injection Testing
python pentest_cli.py scan SQLInjectionScanner -t example.com --url https://example.com/search

# XSS Scanning
python pentest_cli.py scan XSSScanner -t example.com --url https://example.com/contact

# CSRF Testing
python pentest_cli.py scan CSRFScanner -t example.com --url https://example.com/login

# SSL/TLS Analysis
python pentest_cli.py scan SSLTLSAnalyzer -t example.com --host example.com --port 443

# ==> NETWORK SERVICES <==
# SSH Bruteforcing
python pentest_cli.py scan SSHBruteforce -t example.com --host example.com --port 22

# FTP Testing
python pentest_cli.py scan FTPTester -t example.com --host example.com --port 21

# SMB Enumeration
python pentest_cli.py scan SMBEnumerator -t example.com --host example.com

# DNS Enumeration
python pentest_cli.py scan DNSEnumerator -t example.com --domain example.com

# ==> PAYLOAD GENERATION <==
# Reverse Shell Generation
python pentest_cli.py scan PayloadGenerator -t example.com \
    --payload_type reverse_shell --host 10.0.0.1 --port 4444 --platform bash

# Exploit Templates
python pentest_cli.py scan PayloadGenerator -t example.com \
    --payload_type exploit_template --exploit_type sql_injection

# Payload Encoding
python pentest_cli.py scan PayloadGenerator -t example.com \
    --payload_type encoder --input_data "test payload" --encoding_type base64

# ==> PROFILE MANAGEMENT <==
# Target-Profil erstellen
python pentest_cli.py profile create internal \
    --hosts 192.168.1.0/24 10.0.0.0/24 \
    --rate-limit 20 --safe-mode

# Mit Profil scannen
python pentest_cli.py scan PortScanner -p internal

# Konfiguration setzen
python pentest_cli.py config security.safe_mode_default true
```

### GUI Interface

```bash
python pentest_gui.py
```

Die GUI bietet:
- Intuitive Benutzeroberfläche mit Material Design
- Tabbed Interface für verschiedene Funktionen
- Live-Fortschrittsanzeige während Scans
- Vulnerability-Viewer mit Severity-Klassifizierung
- Export-Funktionen für Reports

## Plugin-Entwicklung

Neue Plugins müssen von `BasePlugin` erben:

```python
from core.base_plugin import BasePlugin, PluginResult, PluginStatus, Vulnerability, Severity

class MySecurityPlugin(BasePlugin):
    def __init__(self):
        super().__init__(
            name="MySecurityPlugin",
            version="1.0.0",
            description="Custom security scanning plugin"
        )
    
    def validate_options(self, options: Dict[str, Any]) -> bool:
        # Erforderliche Optionen prüfen
        required = ["target_port", "scan_depth"]
        return all(key in options for key in required)
    
    async def execute(self, target: str, options: Dict[str, Any]) -> PluginResult:
        self.status = PluginStatus.RUNNING
        
        try:
            # Scan-Logik implementieren
            results = await self._perform_scan(target, options)
            
            # Vulnerabilities hinzufügen
            if self._is_vulnerable(results):
                vuln = Vulnerability(
                    title="Beispiel Vulnerability",
                    description="Beschreibung der Schwachstelle",
                    severity=Severity.HIGH,
                    affected_component=f"{target}:{options['target_port']}",
                    recommendation="Empfohlene Gegenmaßnahme"
                )
                self.add_vulnerability(vuln)
            
            self.status = PluginStatus.COMPLETED
            return PluginResult(
                plugin_name=self.name,
                status=self.status,
                data=results,
                timestamp=datetime.now().isoformat()
            )
            
        except Exception as e:
            self.status = PluginStatus.FAILED
            return PluginResult(
                plugin_name=self.name,
                status=self.status,
                data={"error": str(e)},
                errors=[str(e)]
            )
    
    async def _perform_scan(self, target: str, options: Dict[str, Any]):
        # Rate Limiting beachten
        if self._rate_limiter:
            async with self._rate_limiter:
                return await self._actual_scan_logic(target, options)
        return await self._actual_scan_logic(target, options)
```

## Konfiguration

### Sicherheitseinstellungen

```yaml
# config/config.yaml
security:
  target_whitelist: 
    - "192.168.1.0/24"
    - "10.0.0.0/8"
  require_confirmation: true
  audit_logging: true
  safe_mode_default: false
  max_concurrent_scans: 5

network:
  timeout: 30
  retries: 3
  proxy: null
  user_agent: "PentestingSuite/1.0"

reporting:
  default_format: "json"
  include_timestamps: true
  include_raw_data: false
  executive_summary: true
```

### Target-Profile

```yaml
# config/profiles/production.yaml
name: "production"
hosts:
  - "prod-server1.company.com"
  - "prod-server2.company.com"
excluded_hosts:
  - "critical-db.company.com"
rate_limit: 5
safe_mode: true
tags:
  - "production"
  - "critical"
custom_options:
  max_scan_time: 3600
  notification_email: "security@company.com"
```

## Sicherheitsfeatures

### Target Whitelisting
Nur explizit erlaubte Ziele können gescannt werden:
```bash
python pentest_cli.py config security.target_whitelist "192.168.1.0/24,10.0.0.0/8"
```

### Safe Mode
Verhindert potentiell schädliche Scans:
```bash
python pentest_cli.py config security.safe_mode_default true
```

### Audit Logging
Alle Aktivitäten werden in strukturierten Logs erfasst:
```bash
tail -f audit/audit_*.jsonl
```

### Rate Limiting
Begrenzt die Anzahl gleichzeitiger Verbindungen:
```python
# In Plugin-Konfiguration
rate_limit: 10  # Max 10 gleichzeitige Verbindungen
```

## Entwicklung

### Abhängigkeiten installieren
```bash
pip install -r requirements.txt
```

### Code-Qualität
```bash
# Formatierung
black .

# Linting
flake8 .

# Type Checking
mypy .
```

### Tests ausführen
```bash
# Alle Tests
pytest

# Einzelner Test
pytest tests/test_port_scanner.py

# Mit Coverage
pytest --cov=core --cov=plugins
```

## Rechtliche Hinweise

⚠️ **WICHTIG**: Diese Software ist ausschließlich für autorisierte Sicherheitstests bestimmt.

- Verwenden Sie diese Tools nur auf Systemen, für die Sie eine **ausdrückliche schriftliche Erlaubnis** haben
- Aktivieren Sie den Safe Mode für Produktionsumgebungen
- Konfigurieren Sie Target Whitelisting für zusätzliche Sicherheit
- Führen Sie regelmäßige Überprüfungen der Audit Logs durch
- Beachten Sie lokale Gesetze und Vorschriften bezüglich Penetrationstests

## Lizenz

MIT License

Copyright (c) 2025 Martin Pfeffer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Autor

**Martin Pfeffer**  
Software Engineer & Security Researcher  
GitHub: [@martinpfeffer](https://github.com/martinpfeffer)  
E-Mail: martin.pfeffer@example.com

---

**Haftungsausschluss**: Der Autor übernimmt keine Verantwortung für den Missbrauch dieser Software. Die Nutzung erfolgt auf eigene Verantwortung und Gefahr.